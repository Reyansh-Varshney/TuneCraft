"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{82200:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Mt});var n=a(30758);const i="music",o="2.0.0",r="default",s="12.2.0";function c(t){return new l(t)}class l{constructor(t){this._path=[{name:"desktop-friend-activity"}],t?.parentAbsoluteLocation&&(this._parentAbsoluteLocation=t.parentAbsoluteLocation)}addFriendButtonFactory(){return new l.AddFriendButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}closeButtonFactory(){return new l.CloseButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowFactory(){return new l.FriendRowEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}impression(){return{app:i,generatorVersion:s,specificationVersion:o,specificationMode:r,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}!function(t){t.AddFriendButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"add_friend_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.CloseButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"close_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.FriendRowEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"friend_row"}),e&&(this._parentAbsoluteLocation=e)}playButtonFactory(){return new t.FriendRowEventFactory.PlayButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowLinkFactory(e){return new t.FriendRowEventFactory.FriendRowLinkEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation,data:e})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}}}(l||(l={})),function(t){!function(t){t.PlayButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"play_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitPlay({itemToBePlayed:t}){return{actionParameterNames:["item_to_be_played"],actionParameterValues:[t.toString()],actionName:"play",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitPause({itemToBePaused:t}){return{actionParameterNames:["item_to_be_paused"],actionParameterValues:[t.toString()],actionName:"pause",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitResume({itemToBeResumed:t}){return{actionParameterNames:["item_to_be_resumed"],actionParameterValues:[t.toString()],actionName:"resume",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={})),function(t){!function(t){t.FriendRowLinkEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({...a,name:"friend_row_link"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiNavigate({destination:t}){return{actionParameterNames:["destination"],actionParameterValues:[t.toString()],actionName:"ui_navigate",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={}));var u=a(70397),d=a(70257),h=a(32889),p=a(70796),m=a(2061),g=a(79898),_=a(62960),b=a(30831),L=a(19988),x=a(86070);const y=({className:t})=>{const e=(0,L.XB)();return(0,x.jsx)(p.v,{id:"friend-activity-needs-age-assurance-message",variant:"naked",className:t,leading:(0,x.jsx)(m.Z,{semanticColor:"textWarning",size:"small"}),title:(0,x.jsx)(g.d,{variant:"bodySmall",semanticColor:"textSubdued",children:(0,b.v)("Verify your age in order to let friends and followers on Spotify see what youâ€™re listening to.")}),footer:(0,x.jsx)(_.n,{onClick:()=>{e()},size:"small",children:(0,b.v)("Verify your age")}),verticalGap:"tighter",contentAlign:!0})};var f=a(97500),A=a.n(f),j=a(91843);const N="jGcEaPyhr1c_janM2uRF",v="OemaZktMXaRcYQ5bcfLZ",V="o5IJsOJEWBEyxtPVVVqQ",C="toPt7VOT_PiDx5Gj3SM2",w="xU4sacBisQneHoQeHMP5",F="srjSlmxMGzXnJBc32BJa",P="lju7xv10a5Y5Z8h8CcKJ",R="jr794VV4i2iUBRhfvS5i",S="KE3gK5ccLz2gL3dhJ4BW",E="pO2rsGFqUdaNhpLrif21",I="Ydxgl4Y23orfVVVI9O2k",B="VhqWrkzIrJrvdyj7ZXMd",T="T3liC_3fbMOTilR4HHKD",k="W_tr6AMQB9Chbc9bCS9w",M="yDdNxgieZmqjgHQCW3UE",U="aikUDGtqRnCX0ZwYHDUW",Q="fhLkdNCxq2WLCXqQp18z",G="T_HXMW6n5qsbLbPTr1GS",D="tYswKV9PmtTCv62LOPIV",O="GlDNRQ2w0t4h9WBI4GgN",H="BQGSV5BvuAaJ5rmFAXLp",W="ZLbFjRdp1AMXebZH6UWM",Y="jhtyHt6d9vbxK6VtCI7a",Z="oCaGCB13zdReRutfBS8_",z="MR1n58Qu0kPorQtveOCQ",J="y10vXronmQ6eYMlJrIp3",X=({showOnlineIndicator:t})=>(0,x.jsxs)("div",{className:D,children:[(0,x.jsxs)("div",{className:O,children:[(0,x.jsx)(j.v,{size:"medium"}),t?(0,x.jsx)("div",{className:H}):null]}),(0,x.jsxs)("div",{className:W,children:[(0,x.jsx)("div",{className:A()(Y,Z)}),(0,x.jsx)("div",{className:Y}),(0,x.jsx)("div",{className:Y})]})]}),q=()=>(0,x.jsxs)("div",{"data-testid":"buddy-feed-age-assurance",className:U,children:[(0,x.jsx)(y,{className:Q}),(0,x.jsx)(X,{showOnlineIndicator:!0}),(0,x.jsx)(X,{showOnlineIndicator:!0}),(0,x.jsx)(X,{})]});var K=a(60749),$=a(78717),tt=a(73136),et=a(42129);const at=()=>(0,x.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:U,children:[(0,x.jsx)($.E,{as:"p",className:G,children:u.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,x.jsx)(X,{showOnlineIndicator:!0}),(0,x.jsx)(X,{showOnlineIndicator:!0}),(0,x.jsx)(X,{}),(0,x.jsx)($.E,{as:"p",className:G,children:u.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,x.jsx)(K.N_,{to:`/preferences?highlight=${et.a.PUBLISH_LISTENING_ACTIVITY}`,className:z,children:(0,x.jsx)(tt.$,{colorSet:"invertedLight",className:J,children:u.Ru.get("desktop.settings.settings")})})]});a(77369);var nt=a(68832),it=a(18831),ot=a(50375),rt=a(35054),st=a(31016),ct=a(97),lt=a(41672),ut=a(57399),dt=a(53169),ht=a(93624),pt=a(96579),mt=a(26852),gt=a(44900),_t=a(24792),bt=a(48905);const Lt=t=>{const{timestamp:e,isNowPlaying:a}=t;return a?(0,x.jsx)(_t.Zp,{label:u.Ru.get("time.now"),children:(0,x.jsx)(gt.A,{"aria-label":u.Ru.get("time.now"),size:"small"})}):(0,x.jsx)("span",{children:(0,bt.Z)(e)})};var xt=a(28054),yt=a(73048),ft=a(72432),At=a(68293),jt=a(19151);const Nt=t=>Date.now()-t<9e5,vt=(t,e)=>{const a=(0,it.o_h)(t)?.type;switch(a){case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:return(0,x.jsx)(lt.W,{uri:t});case it.NQG.EPISODE:case it.NQG.SHOW:return(0,x.jsx)(ut.H,{uri:t});case it.NQG.ALBUM:return(0,x.jsx)(st.h,{uri:t,artistUri:e});case it.NQG.ARTIST:return(0,x.jsx)(ct.t,{uri:t});default:return null}},Vt=t=>{switch(t){case it.NQG.ALBUM:return jt.c.ALBUM;case it.NQG.ARTIST:return jt.c.ARTIST;case it.NQG.SHOW:return jt.c.SHOW;case it.NQG.EPISODE:return jt.c.EPISODE;case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:return jt.c.PLAYLIST;default:return}},Ct=t=>{const{show:e=!0,spec:a,friend:i}=t,o=(0,n.useMemo)((()=>i.user.imageUrl?[{url:i.user.imageUrl,width:0,height:0}]:[]),[i.user.imageUrl]),r=(0,At.s)(),s=i.track,c=s.uri,{togglePlay:l,isPlaying:d,isActive:h}=(0,ft.P)({uri:c},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),p=(0,it.o_h)(s.context.uri),m=p?.type,g=(0,n.useCallback)((()=>{l();const t=a.friendRowFactory().playButtonFactory();h?d?r.logInteraction(t.hitPause({itemToBePaused:c})):r.logInteraction(t.hitResume({itemToBeResumed:c})):r.logInteraction(t.hitPlay({itemToBePlayed:c}))}),[d,c,a,h,l,r]),_=(0,n.useCallback)(((t,e)=>{r.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:t}).hitUiNavigate({destination:e}))}),[r,a]),{draggable:b,onDragStart:L}=(0,xt.P)({itemUris:[c],dragLabelText:s.name}),{draggable:y,onDragStart:f}=(0,xt.P)({itemUris:[s.artist.uri],dragLabelText:s.artist.name}),{draggable:j,onDragStart:v}=(0,xt.P)({itemUris:[s.context.uri],dragLabelText:s.context.name});return e?(0,x.jsxs)("div",{className:A()(N),children:[(0,x.jsx)(rt.h,{menu:vt(s.context.uri,s.artist.uri),children:(0,x.jsxs)("div",{className:w,children:[(0,x.jsx)(ot.e,{label:i.user.name,width:40,userIconSize:"small",images:o,withBadge:Nt(i.timestamp)}),(0,x.jsx)(mt.x,{className:F,iconClassName:P,isPlaying:d,isLocked:!1,onClick:g,playAriaLabel:d?u.Ru.get("pause"):`${u.Ru.get("play")} ${s.artist.name} ${s.name}`})]})}),(0,x.jsxs)("div",{className:A()(R),children:[(0,x.jsxs)("div",{className:S,children:[(0,x.jsx)($.E,{as:"p",variant:"bodySmallBold",className:A()(E,"ellipsis-one-line"),children:(0,x.jsx)(rt.h,{menu:(0,x.jsx)(ht.B,{uri:i.user.uri}),children:(0,x.jsx)(pt.N,{title:i.user.name,to:i.user.uri,dir:"auto",onClick:()=>_("profile_link",i.user.uri),children:i.user.name})})}),(0,x.jsx)($.E,{as:"p",variant:"marginal",className:A()(I),children:(0,x.jsx)(Lt,{timestamp:i.timestamp,isNowPlaying:Nt(i.timestamp)})})]}),(0,x.jsxs)($.E,{as:"p",variant:"marginal",className:B,children:[(0,x.jsx)(rt.h,{menu:(0,x.jsx)(dt.P,{uri:s.uri,contextUri:s.context.uri,albumUri:s.album.uri,artists:[s.artist]}),children:(0,x.jsx)(pt.N,{title:s.name,to:c,className:"ellipsis-one-line",dir:"auto",draggable:b,onDragStart:L,onClick:()=>_("track_link",c),children:s.name})}),(0,x.jsx)("span",{"aria-hidden":!0,children:"Â â€¢Â "}),(0,x.jsx)(rt.h,{menu:s.artist?(0,x.jsx)(ct.t,{uri:s.artist.uri}):null,children:(0,x.jsx)(pt.N,{title:s.artist.name,to:s.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:y,onDragStart:f,onClick:()=>_("artist_link",s.artist.uri),children:s.artist.name})})]}),(0,x.jsx)($.E,{as:"p",variant:"marginal",className:A()("ellipsis-one-line",k),children:(0,x.jsx)(rt.h,{menu:vt(s.context.uri,s.artist.uri),children:(0,x.jsxs)(pt.N,{title:s.context.name,to:s.context.uri,className:M,draggable:j,onDragStart:v,onClick:()=>_("context_link",s.context.uri),children:[(0,x.jsx)(yt.s,{type:Vt(m),iconSize:16,className:T}),(0,x.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:s.context.name})]})})})]})]},i.user.uri):null};var wt=a(9326),Ft=a(73648),Pt=a(6506);function Rt({friends:t,spec:e}){const a=(0,Pt.g)(),i=(0,Ft.y)(),[o,r]=(0,n.useState)(!0),s=!a&&i&&o&&(0,x.jsx)("li",{className:V,children:(0,x.jsx)(wt.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>r(!1)})},"start-jam-button");return(0,x.jsx)(nt.ZI,{flipKey:t.map((t=>t.user.uri)).join(""),children:(0,x.jsxs)("ul",{className:v,children:[s,t.map(((t,a)=>(0,x.jsx)(nt.lf,{flipId:t.user.uri,children:(0,x.jsx)("li",{children:(0,x.jsx)(Ct,{friend:t,show:a<100,spec:e},t.user.uri)})},t.user.uri)))]})})}var St=a(66293),Et=a(26345),It=a(50092),Bt=a(72664),Tt=a(86247),kt=a(84409);const Mt=({friends:t})=>{const e=(0,At.s)(),{spec:a}=(0,kt.r)(c,{}),i=(0,n.useRef)(null);(0,n.useEffect)((()=>{e.logImpression(a.impression())}),[e,a]);const o=0===t.length,r=(0,n.useCallback)((()=>{e.logInteraction(a.closeButtonFactory().hitUiHide())}),[e,a]),s=(0,d.F)(),l=(0,h.n)();let p;return p=s&&"AGE_ASSURANCE_REQUIRED"===l?(0,x.jsx)(q,{}):o?(0,x.jsx)(at,{}):(0,x.jsx)(Rt,{friends:t,spec:a}),(0,x.jsx)(Tt.ql.Provider,{value:"buddy_feed",children:(0,x.jsx)(St._,{label:u.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,x.jsx)("div",{className:C,ref:i,children:(0,x.jsx)(Et.w,{fixedHeader:(0,x.jsx)(It.a,{title:u.Ru.get("buddy-feed.friend-activity"),panel:Bt.Z.BuddyFeed,onClose:r}),children:p})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map