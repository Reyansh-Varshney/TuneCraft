"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9718],{5488:(e,t,a)=>{a.d(t,{J:()=>u});var s=a(60749),i=a(35394),n=a(36585),r=a(70397),l=a(57642),d=a(72024),c=a(19239),o=a(86070);const u=({leavebehinds:e,surface:t,uri:a,pathname:u,state:h})=>{const v=(0,c.vh)(),_=`${r.Ru.get("view.see-all")} (${e.length<=d.E9?r.Ru.formatNumber(e.length):r.Ru.formatNumber(d.E9)})`;return(0,o.jsx)(s.N_,{to:u,state:h,children:(0,o.jsx)(i.H,{"data-testid":"leavebehinds-see-all",size:"small",onClick:()=>{v.send((0,n.x)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:(0,l.Fh)(t),uri:a}))},children:_})})}},30382:(e,t,a)=>{a.d(t,{o:()=>w});a(86328),a(77369);var s=a(30758),i=a(78717),n=a(21765),r=a(90238),l=a(36585),d=a(70397),c=a(70796),o=a(79898),u=a(10622),h=a(74291),v=a(73136),_=a(91119),b=a(96579);const m="c5Ml9BbBuUEHjNkcSwZA";var g=a(86070);const p="70px",f=({adId:e,advertiser:t,tagline:a,displayImage:s,buttonMessage:i,cardOnClick:n,buttonOnClick:r,clickthroughUrl:l})=>(0,g.jsx)(b.N,{to:(0,_.H)(l),className:m,"data-testid":"leavebehind",children:(0,g.jsx)(c.v,{onClick:n,onClickHint:d.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:e,size:"xl",title:(0,g.jsx)(o.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:t}),subtitle:(0,g.jsx)(u.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:a}),media:(0,g.jsx)(h.C,{"data-testid":"leavebehind-image",src:s.src,alt:s.alt,imageHeight:p,imageWidth:p,size:"xl"}),trailing:(0,g.jsx)(v.$,{onClick:()=>{r&&r()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":d.Ru.get("ad-formats.learnMore"),children:i})})});var y=a(57642),k=a(17383),I=a(72024),x=a(19239);const q="zlUJfROzFEOsEDWL7ucP",E="Fxvq1Fw7XQdGRDvYokRg",w=({leavebehinds:e,seeAllButton:t,surface:a,uri:c})=>{const o=(0,x.vh)(),u=(0,k.w)(k.P),[h,v]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{e&&e.length>0&&h!==e[0].requestId&&c&&(e.forEach(((e,t)=>{e.uri===c&&(e.trackingEvents?.viewed.forEach((async t=>{try{await u(t)}catch(s){const i=s;o.send((0,r.G)({error_type:"trackingURLFailure",error_message:i.message,http_error_code:422,surface:(0,y.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,I.Zl)(a)}))}})),o.send((0,l.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:`viewed_on_${(0,y.Fh)(a).toLowerCase()}`,surface:(0,y.Fh)(a),surface_position:t+1,uri:c})))})),v(e[0].requestId))}),[o,u,e,c,a,h]);const _=({eventReason:e,lineitemId:t,requestId:s,trackingEvents:i,surfacePosition:n})=>{((e,t)=>{t?.forEach((async t=>{try{await u(t)}catch(s){const i=s;o.send((0,r.G)({error_type:"trackingURLFailure",error_message:i.name,http_error_code:422,surface:(0,y.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,I.Zl)(a)}))}}))})(t,i),o.send((0,l.x)({leavebehind_lineitem_id:t,leavebehind_request_id:s,event:"event_clicked",event_reason:e,surface:(0,y.Fh)(a),surface_position:n,uri:c}))};return(0,g.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,g.jsxs)("div",{className:E,children:[(0,g.jsx)(i.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,n.po)("tighter"),"data-testid":"leavebehinds-title",children:d.Ru.get("podcast-ads.recent_ads")}),t]}),(0,g.jsx)("div",{className:q,"data-testid":"leavebehinds-list-wrapper",children:e.map(((e,t)=>(0,g.jsx)(f,{...e,buttonOnClick:()=>{_({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:()=>{_({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})}},e.adId)))})]})}},42088:(e,t,a)=>{a.d(t,{A:()=>m});var s=a(30758),i=a(18611),n=a(19507),r=a(90238),l=a(65809),d=a(99129),c=a(57642),o=a(72024),u=a(19239),h=a(59161),v=a(76972),_=a(17026);const b=(e,t,a,s)=>["useGetLeavebehindsData",e,t,a,s];const m=function(e){const t=(0,u.vh)(),a=(0,l.NC)(h.SAn,{loadingValue:!1}),{data:m,isError:g,error:p,refetch:f}=(0,n.I)({queryKey:b(e.uri,e.surface,e.playlistName,a),queryFn:()=>(async(e,t,a,s)=>(await d.b6(v.n.getInstance(),(0,c.Fh)(t),e,a,s)).body)(e.uri,e.surface,e.playlistName,a),select:t=>t&&0!==t.leavebehindAds.length?(0,o.iT)(t,e.uri):[],enabled:!!e.uri,retry:!1});if(g&&p){const a=p instanceof _.O,s=a?p.name:"Error fetching leavebehind ads data",n=a?p.status:void 0;t.send((0,r.G)({error_type:"fetchAdsFailure",error_message:s,http_error_code:n,surface:(0,c.Fh)(e.surface),request_type:"leavebehindAds",ad_content_origin:(0,o.Zl)(e.surface)})),(0,i.Cp)(s)}return{data:m,isError:g,getLeavebehinds:(0,s.useCallback)((()=>{f()}),[f])}}},73269:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});a(87175);var s=a(62411),i=a(18831),n=a(30382),r=a(5488),l=a(57642),d=a(72024),c=a(86070);const o=({uri:e,playlistId:t,leavebehinds:a,playlistName:s})=>{const i=l.ui.PLAYLIST;return a&&a.length>0?(0,c.jsx)(n.o,{surface:i,uri:e,leavebehinds:a.slice(0,d.pU),seeAllButton:a.length>d.pU?(0,c.jsx)(r.J,{leavebehinds:a,surface:i,pathname:`/playlist/${t}/see-all-ads`,state:{uri:e,playlistName:s},uri:e}):null}):null};var u=a(42088);const h=e=>e.ads.sponsoredPlaylist.sponsoredPlaylist.get("allSponsorships"),v=({uri:e,playlistName:t})=>{const a=(0,i.o_h)(e)?.id,n=(0,s.d4)(h),r=n?.some((e=>e.playlistId===a)),d=l.ui.PLAYLIST,{data:v,isError:_}=(0,u.A)({surface:d,uri:e,playlistName:t});return!v||v.length<1||_||r?null:a?(0,c.jsx)(o,{uri:e,playlistId:a,leavebehinds:v,playlistName:t}):null}}}]);
//# sourceMappingURL=playlist-leavebehinds.js.map