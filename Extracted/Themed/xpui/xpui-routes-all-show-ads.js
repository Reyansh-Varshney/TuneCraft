"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1845],{11107:(e,t,a)=>{a.d(t,{e:()=>r});const i="KVsgerBH7s4FpX3cdwww";var s=a(86070);const r=({children:e})=>(0,s.jsx)("div",{className:i,children:e})},30382:(e,t,a)=>{a.d(t,{o:()=>q});a(86328),a(77369);var i=a(30758),s=a(78717),r=a(21765),n=a(90238),d=a(36585),l=a(70397),c=a(70796),o=a(79898),u=a(10622),h=a(74291),v=a(73136),_=a(91119),g=a(96579);const f="c5Ml9BbBuUEHjNkcSwZA";var b=a(86070);const m="70px",p=({adId:e,advertiser:t,tagline:a,displayImage:i,buttonMessage:s,cardOnClick:r,buttonOnClick:n,clickthroughUrl:d})=>(0,b.jsx)(g.N,{to:(0,_.H)(d),className:f,"data-testid":"leavebehind",children:(0,b.jsx)(c.v,{onClick:r,onClickHint:l.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:e,size:"xl",title:(0,b.jsx)(o.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:t}),subtitle:(0,b.jsx)(u.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:a}),media:(0,b.jsx)(h.C,{"data-testid":"leavebehind-image",src:i.src,alt:i.alt,imageHeight:m,imageWidth:m,size:"xl"}),trailing:(0,b.jsx)(v.$,{onClick:()=>{n&&n()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":l.Ru.get("ad-formats.learnMore"),children:s})})});var k=a(57642),y=a(17383),w=a(72024),x=a(19239);const I="zlUJfROzFEOsEDWL7ucP",E="Fxvq1Fw7XQdGRDvYokRg",q=({leavebehinds:e,seeAllButton:t,surface:a,uri:c})=>{const o=(0,x.vh)(),u=(0,y.w)(y.P),[h,v]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{e&&e.length>0&&h!==e[0].requestId&&c&&(e.forEach(((e,t)=>{e.uri===c&&(e.trackingEvents?.viewed.forEach((async t=>{try{await u(t)}catch(i){const s=i;o.send((0,n.G)({error_type:"trackingURLFailure",error_message:s.message,http_error_code:422,surface:(0,k.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,w.Zl)(a)}))}})),o.send((0,d.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:`viewed_on_${(0,k.Fh)(a).toLowerCase()}`,surface:(0,k.Fh)(a),surface_position:t+1,uri:c})))})),v(e[0].requestId))}),[o,u,e,c,a,h]);const _=({eventReason:e,lineitemId:t,requestId:i,trackingEvents:s,surfacePosition:r})=>{((e,t)=>{t?.forEach((async t=>{try{await u(t)}catch(i){const s=i;o.send((0,n.G)({error_type:"trackingURLFailure",error_message:s.name,http_error_code:422,surface:(0,k.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,w.Zl)(a)}))}}))})(t,s),o.send((0,d.x)({leavebehind_lineitem_id:t,leavebehind_request_id:i,event:"event_clicked",event_reason:e,surface:(0,k.Fh)(a),surface_position:r,uri:c}))};return(0,b.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,b.jsxs)("div",{className:E,children:[(0,b.jsx)(s.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,r.po)("tighter"),"data-testid":"leavebehinds-title",children:l.Ru.get("podcast-ads.recent_ads")}),t]}),(0,b.jsx)("div",{className:I,"data-testid":"leavebehinds-list-wrapper",children:e.map(((e,t)=>(0,b.jsx)(p,{...e,buttonOnClick:()=>{_({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:()=>{_({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})}},e.adId)))})]})}},42088:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(30758),s=a(18611),r=a(19507),n=a(90238),d=a(65809),l=a(99129),c=a(57642),o=a(72024),u=a(19239),h=a(59161),v=a(76972),_=a(17026);const g=(e,t,a,i)=>["useGetLeavebehindsData",e,t,a,i];const f=function(e){const t=(0,u.vh)(),a=(0,d.NC)(h.SAn,{loadingValue:!1}),{data:f,isError:b,error:m,refetch:p}=(0,r.I)({queryKey:g(e.uri,e.surface,e.playlistName,a),queryFn:()=>(async(e,t,a,i)=>(await l.b6(v.n.getInstance(),(0,c.Fh)(t),e,a,i)).body)(e.uri,e.surface,e.playlistName,a),select:t=>t&&0!==t.leavebehindAds.length?(0,o.iT)(t,e.uri):[],enabled:!!e.uri,retry:!1});if(b&&m){const a=m instanceof _.O,i=a?m.name:"Error fetching leavebehind ads data",r=a?m.status:void 0;t.send((0,n.G)({error_type:"fetchAdsFailure",error_message:i,http_error_code:r,surface:(0,c.Fh)(e.surface),request_type:"leavebehindAds",ad_content_origin:(0,o.Zl)(e.surface)})),(0,s.Cp)(i)}return{data:f,isError:b,getLeavebehinds:(0,i.useCallback)((()=>{p()}),[p])}}},99173:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var i=a(85387),s=a(30382),r=a(11107),n=a(42088),d=a(72024),l=a(86070);function c({surface:e}){const t=(0,i.zy)().state,{data:a,isError:c}=(0,n.A)({surface:e,uri:t.uri});return!a||a.length<1||c?null:(0,l.jsx)(r.e,{children:(0,l.jsx)(s.o,{leavebehinds:a.slice(0,d.E9),surface:e,uri:t.uri})})}}}]);
//# sourceMappingURL=xpui-routes-all-show-ads.js.map