"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{11829:(e,t,a)=>{a.d(t,{$:()=>i});var s=a(85387);const n="/lyrics",i=()=>{const e=(0,s.zy)(),t=e.pathname.startsWith(n);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:n}}},28153:(e,t,a)=>{a.d(t,{w:()=>u});var s=a(30758),n=a(41919),i=a(70397),o=a(30929),r=a(48220),c=a(80357),l=a(84409);const u=({uri:e,isBook:t})=>{const{add:a,remove:u}=(0,c.p)("prerelease"),d=(0,r.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,o.d)(),{spec:g,logger:p}=(0,l.r)(n.k,{data:{uri:e}});return{isPreSaved:d,addPresave:(0,s.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await a(e),m(t?i.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):i.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[a,m,t,p,g,e]),removePresave:(0,s.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await u(e)}),[p,u,g,e])}}},49664:(e,t,a)=>{a.d(t,{Er:()=>u,P3:()=>c,aC:()=>l,qn:()=>r});var s=a(42551),n=a(52793);const i=e=>e.ads,o=(e,t)=>t,r=(0,s.Mz)(i,(e=>{const t=e.sponsoredPlaylist.sponsoredPlaylist.get("allSponsorships");return Array.isArray(t)?t:null})),c=(0,s.Mz)(i,(e=>e.sponsoredPlaylist.previewAd)),l=(0,s.Mz)([r,o],((e,t)=>!!e&&(0,n.Z_)(e,t))),u=(0,s.Mz)([i,o],((e,t)=>{const a=e.sponsoredPlaylist.sponsoredPlaylist.get(t);if(!Array.isArray(a))return a}))},75558:(e,t,a)=>{a.d(t,{NowPlayingBar:()=>rn});var s=a(30758),n=a(97500),i=a.n(n),o=a(62411),r=a(94079),c=a(70397),l=a(9175),u=a(83921),d=a(49664),m=a(73636),g=a(52793),p=a(63304),v=a(83953),b=a(39737);var y=a(78717),h=a(73136);const C="dz_h98rH9nZCwfPdnKgr",k="rAfV2jB_HMM9Xtr0Rqvn",x="XkXPpDRWozMF6G8_GlLQ";var N=a(86070);const f=s.memo((function(e){const{handleClick:t}=e,a=c.Ru.get("pta.bottom-bar.title"),s=c.Ru.get("fta.bottom-bar.subtitle"),n=c.Ru.get("fta.sign-up-free");return(0,N.jsxs)("div",{className:C,onClick:t,"data-testid":"signup-bar",children:[(0,N.jsxs)("div",{className:k,children:[(0,N.jsx)(y.E,{as:"p",variant:"bodySmallBold",children:a}),(0,N.jsx)(y.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:s}})]}),(0,N.jsx)(h.$,{colorSet:"invertedLight",onClick:t,className:x,children:n})]})}));var j=a(9779),A=a(42805),I=a(1974),S=a(39896),T=a(77335),D=a(28848),P=a(57230),w=a(84409);const E="gqYYMz8DkhaT3e44LcHQ",R="VX33mI2V_jRA7hRBI9_0",B=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:a,omitConnectionStateText:s=!1})=>{const{spec:n,logger:i}=(0,w.r)(I.s,{}),{triggerRef:o,toggleDevicePicker:r,isPickerOpen:l}=(0,T.z)(),u=(0,D.$A)(t,a),d=a===P.zP.CONNECTED?c.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):c.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(u,{size:"small",className:R,role:"presentation",semanticColor:"essentialBase"}),(0,N.jsx)(A.Y,{component:"button",onClick:()=>{const e=n.activeDeviceButtonFactory(),{interactionId:t}=i.logInteraction(l?e.hitUiHide():e.hitUiReveal()),a=l;r(t),a||(0,S.I)("DEVICE-PICKER")},ref:o,className:E,children:(0,N.jsx)(y.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:s&&a===P.zP.CONNECTED?e:d})})]})},O="nQSM_BrSHJ4Cp3XSuLOF",_=()=>(0,N.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:O,children:[(0,N.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,N.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,N.jsx)("defs",{children:(0,N.jsx)("clipPath",{id:"clip0_491_88335",children:(0,N.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var F=a(25856),L=a(68745),V=a(69937),M=a(6506),U=a(86246);const z="main-connectBar-connectBar",q="main-connectBar-connected",H="main-connectBar-connecting",K=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:a,remoteDeviceType:s}=(0,V.v)((e=>{const t=(0,L.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),U.a),n=(0,M.g)(),o=e&&a&&s;if(!o&&!n)return null;const r=t===P.zP.CONNECTED||n,c=t===P.zP.CONNECTING&&!n;return(0,N.jsxs)("div",{className:i()(z,{"encore-bright-accent-set":r,[q]:r,[H]:c}),children:[n&&(0,N.jsx)(F.K,{}),n&&o&&(0,N.jsx)(_,{}),o&&(0,N.jsx)(B,{connectionStatus:t,remoteDeviceName:a,remoteDeviceType:s,omitConnectionStateText:n})]})},Y=()=>(0,N.jsx)(s.Suspense,{fallback:null,children:(0,N.jsx)(K,{})});var G=a(65809),W=a(3669),Q=a(78993),Z=a(29032),X=a(90235),$=a(75500),J=a(59161),ee=a(46024);var te=a(52427),ae=a(37202),se=a(96768),ne=a(35394),ie=a(24792);const oe="main-genericButton-button",re="main-genericButton-buttonActive",ce="main-genericButton-buttonActiveDot",le=(0,s.forwardRef)(((e,t)=>{const a=e.isActive??!1,s=i()(oe,{[re]:a||e.isActiveNoIndicator,[ce]:a},e.className);return(0,N.jsx)(ie.Zp,{label:e.label,children:(0,N.jsx)(ne.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:s,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":a.toString(),"aria-pressed":a,"data-restore-focus-key":e.restoreFocusKey,"aria-describedby":e.ariaDescribedby})})}));var ue=a(16821),de=a(87585);var me=a(15496),ge=a(68688);const pe="connect-message-nudge",ve="O8rZyzX8hHFyZlCUJq0c",be=({onClose:e,onMouseEnter:t,onMouseLeave:a,onClick:s,impressionCallback:n,message:i})=>(0,N.jsx)("div",{ref:n,onMouseEnter:t,onMouseLeave:a,onClick:s,children:(0,N.jsx)(ge.z,{onClose:t=>{t.stopPropagation(),e?.()},isAllowedDuringCinemaMode:!0,className:ve,maxWidth:336,children:(0,N.jsx)(y.E,{id:pe,as:"p",variant:"bodyMedium",semanticColor:"textBase",children:i})})});var ye=a(41836),he=a(99375);const Ce=(e=ye.C)=>{const t=(0,o.Pj)(),{isActive:a}=e(),s=(0,he.h)();return document.hasFocus()&&!a&&!(({ui:e,ads:t},a)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||a)(t.getState(),s.current.length>0)};var ke=a(88378);var xe=a(56428),Ne=a(15517),fe=a(76754),je=a(92852),Ae=a(4666),Ie=a(33562),Se=a(49831),Te=a(36849);const De=e=>{const t=(0,s.useRef)(),a=(0,s.useRef)(),n=(0,s.useRef)(!1),i=(0,Ae.z)(),o=(0,Ne.Z)(),{spec:r,logger:l}=(0,w.r)(ke.w,{}),u=(0,s.useRef)(null),d=(0,s.useCallback)((()=>{l.logInteraction(r.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[r,l]),m=(0,s.useCallback)((e=>{e&&u.current!==e&&l.logImpression(r.djVoiceUnsupportedNudgeFactory().impression()),u.current=e}),[r,l]),g=(0,s.useCallback)((()=>{const e=i.getState(),t=o.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,Te.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==Se.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[i,o]),p=(0,s.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:c.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:d,impressionCallback:m})}),[e,g,d,m]),v=(0,s.useCallback)((e=>{e.data.action===je.Ik.PLAY&&(n.current=!0)}),[]);(0,Ie.p)(je.gd.ACTION,v);const b=(0,s.useCallback)((e=>{n.current&&(0,Te.uW)(e.data)===Se.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,n.current=!1)}),[p]);(0,Ie.p)(je.gd.UPDATE,b);const y=(0,s.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&a.current!==t.connectStateId&&p(),a.current=t?.connectStateId}),[p]);(0,fe.W)(xe.P.UPDATE,y)};a(87175);var Pe=a(12295);const we=e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&(e=>{switch(e.type){case P.bq.AUDIO_DONGLE:case P.bq.AVR:case P.bq.CAST_AUDIO:case P.bq.CAST_VIDEO:case P.bq.GAME_CONSOLE:case P.bq.SPEAKER:case P.bq.STB:case P.bq.TV:return!0;default:return!1}})(e)));var Ee=a(98634),Re=a(12912),Be=a(44500),Oe=a(92713);const _e=new Date(0).toISOString(),Fe=["shift+alt+f10"],Le=e=>{const t=(0,s.useRef)(),a=(0,s.useRef)(!1),n=(0,s.useRef)(!1),i=(0,Ae.z)(),o=(0,Ne.Z)(),r=(0,Be.V)(),[l,u]=(0,Oe.x)("connect-nudge-triggered-at",_e),d=(0,s.useRef)(null),{spec:m,logger:g}=(0,w.r)(ke.w,{}),p=(0,s.useCallback)((()=>{g.logInteraction(m.connectFromDevicePickerNudgeFactory().hitNoAction())}),[m,g]),v=(0,s.useCallback)((()=>{g.logInteraction(m.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[m,g]),b=(0,s.useCallback)((e=>{e&&d.current!==e&&g.logImpression(m.connectFromDevicePickerNudgeFactory().impression()),d.current=e}),[m,g]),{isDeveloperMode:y}=(0,Re.V)();(0,Ee.f)(Fe,(async()=>{if(y){const e=new Date;e.setHours(e.getHours()-8),u(e.toISOString())}}));const h=(0,s.useCallback)((()=>{const e=i.getState(),t=o.getActiveDevice(),a=o.getDevices(),s=r.getDefaultDevice(),n=new Date(l);n.setHours(n.getHours()+8);return n<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,Te.A3)(e)&&we(a)&&(e=>!e||!(e.terminalType===Pe.FI.HEADPHONES||e.terminalType===Pe.FI.SPEAKERS&&(e.transportType===Pe.Yg.BLUETOOTH||e.transportType===Pe.Yg.USB)))(s)}),[i,r,l,o]),C=(0,s.useCallback)((()=>{if(h()){e({nudgeType:"message-only-nudge",message:c.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:b,onClick:p,onClose:v});const t=(new Date).toISOString();u(t)}}),[e,h,u,p,v,b]),k=(0,s.useCallback)((e=>{e.data.action===je.Ik.PLAY?a.current=!0:e.data.action===je.Ik.RESUME&&(n.current=!0)}),[]);(0,Ie.p)(je.gd.ACTION,k);const x=(0,s.useCallback)((e=>{a.current&&(0,Te.uW)(e.data)===Se.i.PLAYING?(t.current=e.data?.context.uri,C(),t.current=void 0,a.current=!1):n.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,C(),t.current=void 0,n.current=!1)}),[C]);(0,Ie.p)(je.gd.UPDATE,x)},Ve=e=>{Le(e),De(e)};var Me=a(48729);const Ue=()=>{const e=(0,s.useRef)(),t=(0,s.useRef)(!1),a=(0,s.useRef)(!1),n=(0,o.wA)(),i=(0,o.d4)((e=>e.ui.connectNudge.isOpen)),r=(0,o.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,s.useCallback)((()=>{a.current&&(clearTimeout(e.current),a.current=!1),n((0,Me.Yp)())}),[n]),l=(0,s.useCallback)((()=>{a.current=!1,t.current||c()}),[c]),u=(0,s.useCallback)((()=>{e.current=window.setTimeout(l,8e3),n((0,Me.dK)()),a.current=!0}),[n,l]),d=(0,s.useCallback)((e=>{t.current=e,e||a.current||c()}),[c]);return(0,s.useEffect)((()=>{r&&c()}),[r,c]),(0,s.useMemo)((()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:i})),[c,u,d,i])},ze=({children:e,useNudgeTriggers:t=Ve,useToggleNudgeWithTimer:a=Ue,useCanShowNudge:n=Ce,disabled:i=!1})=>{const{showNudge:o,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=a(),[u,d]=(0,s.useState)(null),m=n();(0,s.useEffect)((()=>{l&&!m&&r()}),[m,r,l]),t((e=>!(l||!m)&&(d(e),o(),!0)));const g=(0,s.useCallback)((e=>{if(!e)return(0,N.jsx)(N.Fragment,{});return(0,N.jsx)(be,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),r()}})}),[r,c]);return(0,N.jsx)(me.E,{isVisible:Boolean(u?.message)&&l&&!i,content:g(u),children:e})};var qe=a(720),He=a(72664),Ke=a(73525);const Ye=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:a}=(0,V.v)((e=>{const t=(0,L.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),U.a),n=(0,ue.g)(),{isActive:i}=(0,qe.AI)(He.Z.DevicePickerOverlay),{canTogglePanel:o,isActive:r,togglePanel:l}=(0,de.C)(),{spec:u,logger:d}=(0,w.r)(se.p,{}),m=(0,s.useCallback)((()=>{const{interactionId:e}=d.logInteraction(function(e,t,a){return {interactionId:null,pageInstanceId:null};let s;return s=t===P.zP.CONNECTING?e.connectingButtonFactory():t===P.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),a?s.hitUiHide():s.hitUiReveal()}(u,a,r));l(e)}),[a,l,r,u,d]),{currentDevice:g}=(0,Ke.l)(),{isLocal:p}=g,v=(0,s.useMemo)((()=>(0,D.tf)(e,t,p?n:null)),[n,p,t,e]);return(0,N.jsx)(ze,{children:(0,N.jsx)(le,{isActive:r,disabled:!o,onToggle:m,label:c.Ru.get("playback-control.connect-picker"),icon:v,restoreFocusKey:i?He.Z.DevicePickerOverlay:He.Z.DevicePicker,ariaDescribedby:pe})})},Ge=()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht);return e?null:(0,N.jsx)(Ye,{})};var We=a(23690),Qe=a(97648),Ze=a(90153),Xe=a(58063),$e=a(66921);const Je=({className:e="",disabledClassName:t="",onClick:a})=>{const n=(0,Xe.l)(),o=(0,b.o)((e=>e?.hasContext??!1)),r=(0,Ze.l)(),l=!o,{toggleFullScreen:u,isInFullScreen:d}=(0,$e.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),m=(0,s.useCallback)((()=>{const e=d?W.z.CLOSED:W.z.NOW_PLAYING_VIEW;u(),setTimeout((()=>{r(e)}),1)}),[d,r,u]),g=(0,s.useCallback)((async()=>{o&&(a?.(!0),m())}),[o,a,m]),p=d?We.z:Qe.T,v=d?c.Ru.get("web-player.cinema-mode.fullscreen.exit"):c.Ru.get("web-player.cinema-mode.fullscreen.enter"),y=i()(e,{[t]:l});return n?(0,N.jsx)(le,{onToggle:g,className:y,icon:p,label:v,disabled:l,testId:"fullscreen-mode-button"}):null},et=(0,s.memo)(Je);var tt=a(95614),at=a(18831),st=a(11829),nt=a(7789),it=a(3337);const ot=s.memo((({onClick:e,className:t,isActive:a,isEnabled:s})=>{const n=s?c.Ru.get("web-player.lyrics.title"):c.Ru.get("web-player.lyrics.noLyrics1"),i=s?e:void 0;return(0,N.jsx)(le,{className:t,isActive:a,onToggle:i,disabled:!s,label:n,testId:"lyrics-button",icon:tt.q})})),rt=s.memo((e=>{const t=Boolean((0,it.J)().data?.hasLyrics);return(0,N.jsx)(ot,{...e,isEnabled:t,isActive:!1})})),ct=s.memo((e=>{const t=(0,b.o)((e=>e?.item?.uri)),a=Boolean((0,nt.f)(t).hasLyrics);return(0,N.jsx)(ot,{...e,isEnabled:a,isActive:!1})})),lt=s.memo((e=>{const t=(0,Q.S)(),{currentVariant:a}=(0,Z.r)(),{isActiveNotCinemaMode:s}=(0,st.$)(),{isAnonymous:n}=(0,o.d4)(v.Ht),i=(0,G.NC)(J.khs),r=(0,b.o)((e=>{if(e?.item?.uri&&(0,at.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));if(n||!r)return null;const c=t===W.z.NOW_PLAYING_VIEW&&"lyrics"===a,l=s||c;return l?(0,N.jsx)(ot,{...e,isActive:l,isEnabled:!0}):i?(0,N.jsx)(rt,{...e}):(0,N.jsx)(ct,{...e})}));var ut=a(85387),dt=a(15594),mt=a(25140);const gt=({onClick:e,className:t})=>{const a=(0,Q.S)(),{currentVariant:s,previousVariant:n}=(0,Z.r)(),i=(0,X.F)(),{toggleLyrics:o}=function({referrer:e,onChange:t}){const a=(0,ut.Zp)(),{isActive:s,routeDestination:n}=(0,st.$)(),i=(0,mt.f)(),o=()=>{s||(a(n,{state:{referrer:e}}),t?.(s))},r=()=>{if(s){const e="/",n=i.uri===dt.N6?e:(0,at.o_h)(i.uri)?.toURLPath(!0)??e;a(n),t?.(s)}};return{isActive:s,showLyrics:o,hideLyrics:r,toggleLyrics:()=>{s?r():o()}}}({onChange:e,referrer:"now_playing_bar"}),r=a===W.z.NOW_PLAYING_VIEW;return(0,N.jsx)(lt,{onClick:r?()=>{i("lyrics"===s?n??"artwork":"lyrics")}:o,className:t})};var pt=a(61719),vt=a(56572);const bt=vt.$S.NPV_BUTTON_CLICK,yt=({onClick:e})=>{const{isActive:t,panelSend:a}=(0,qe.AI)(He.Z.NowPlayingView),s=(0,qe.Ev)(bt),n=(0,G.NC)(J.ZDY),i=(0,Q.S)(),o=(0,Ze.l)(),{item:r}=(0,b.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),l=!r||!s,u=i===W.z.NOW_PLAYING_VIEW;if(n)return null;const d=t&&!u;return(0,N.jsx)(le,{isActive:d,disabled:l,onToggle:()=>{e?.(!t),u?((0,S.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),o(W.z.CLOSED),t||a(bt)):a(bt)},icon:pt.d,label:c.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:He.Z.NowPlayingView})};var ht=a(42029),Ct=a(72983),kt=a(36195),xt=a(24639),Nt=a(69466);const ft=[Ct.fl.TRACKS,Ct.fl.LOCAL_TRACKS,Ct.fl.EPISODES],jt=vt.$S.QUEUE_BUTTON_CLICK,At=({onClick:e})=>{const{isEnabled:t,isVisible:a}=(()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht);return e?{isVisible:!1}:{isVisible:!0,isEnabled:!0}})(),n=(0,qe.Ev)(jt),{isActive:i}=(0,qe.AI)(He.Z.Queue,He.Z.QueueOverlay),{toggleQueue:r}=(0,Nt.R)(),l=(0,s.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!i}),r())}),[t,e,i,r]),{className:u,dropPosition:d,...m}=(()=>{const{openQueue:e}=(0,Nt.R)(),t=(0,Ae.z)(),a=(0,s.useCallback)((()=>{e()}),[e]),n=(0,s.useCallback)((e=>{const{[Ct.fl.TRACKS]:a=[],[Ct.fl.LOCAL_TRACKS]:s=[],[Ct.fl.EPISODES]:n=[]}=e,i=[...a,...s,...n];t.addToQueue(i.map((e=>({uri:e,uid:null}))))}),[t]);return(0,xt.A)({allowedMimeTypesByDropPosition:{[kt.Nz.ON]:ft},onDrop:n,onLongDragOver:a})})();return a?(0,N.jsx)("div",{className:u,...m,children:(0,N.jsx)(le,{icon:ht.j,label:c.Ru.get("playback-control.queue"),onToggle:l,isActive:i,disabled:!t||!n,testId:"control-button-queue",restoreFocusKey:He.Z.Queue})}):null};var It=a(70133),St=a(80065),Tt=a(97002);const Dt=({onClick:e})=>{const{item:t}=(0,St.L)()??{},{isActive:a,onClick:s,showButton:n}=(0,Tt.D)({item:t,onClick:e});return t&&n?(0,N.jsx)(le,{isActive:a,onToggle:s,label:a?c.Ru.get("miniplayer.close"):c.Ru.get("miniplayer.open"),icon:It.F,testId:"pip-toggle-button"}):null};var Pt=a(4405),wt=a(69390);const Et="main-nowPlayingBar-extraControls",Rt="main-nowPlayingBar-lyricsButton",Bt="main-nowPlayingBar-volumeBar",Ot=()=>{const e=(0,G.NC)(J.L$q),{spec:t,logger:a,UBIFragment:s}=(0,w.r)(ae.h9,{data:{identifier:ae.gw.DESKTOP}}),n=(0,te.YQ)((e=>{a.logInteraction(t.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0});return(0,N.jsx)(s,{spec:t,children:(0,N.jsxs)("div",{className:Et,children:[(0,N.jsx)(wt.mA,{onClick:()=>{a.logInteraction(t.djJumpButtonFactory().hitRefreshContent())}}),(0,N.jsx)(yt,{onClick:e=>{e?a.logInteraction(t.npvButtonFactory().hitUiReveal()):a.logInteraction(t.npvButtonFactory().hitUiHide())}}),e===J.vkU.CONTROL&&(0,N.jsx)(gt,{className:Rt,onClick:e=>{e?a.logInteraction(t.lyricsButtonFactory().hitUiNavigateBack()):a.logInteraction(t.lyricsButtonFactory().hitUiNavigate({destination:"spotify:app:lyrics"}))}}),(0,N.jsx)(At,{onClick:e=>{"main"===e.mode?e.route?a.logInteraction(t.queueButtonFactory().hitUiNavigate({destination:e.route})):a.logInteraction(t.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?a.logInteraction(t.queueButtonFactory().hitUiReveal()):a.logInteraction(t.queueButtonFactory().hitUiHide())}}),(0,N.jsx)(Ge,{}),(0,N.jsx)(Pt.M,{className:Bt,onVolumeBarClick:e=>{a.logInteraction(t.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?a.logInteraction(t.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&a.logInteraction(t.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:n}),(0,N.jsx)(Dt,{}),(0,N.jsx)(et,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&a.logInteraction(t.fullscreenButtonFactory().hitUiReveal())}})]})})};var _t=a(43039),Ft=a(86749),Lt=a(19151);const Vt="yyrJTUPMeLS8qs1a0YJr",Mt=({logoUrl:e})=>e?(0,N.jsx)("div",{className:Vt,"data-testid":"context-ad-logo",children:(0,N.jsx)(Ft.N,{loading:"eager",imgSrc:e,width:56,height:56,type:Lt.c.AD})}):null;var Ut=a(12e3),zt=a(29552),qt=a(44463);const Ht=({item:e,context:t,index:a})=>{const{logoImage:s}=(0,Ut.b)(e);return(0,N.jsx)(qt.e,{item:e,context:t,index:a,"aria-label":c.Ru.get("ad-formats.advertisement"),adEventReason:zt.c.AD_LOGO,isVisible:!1,children:(0,N.jsx)(Mt,{logoUrl:s})})};var Kt=a(38042),Yt=a(19906);const Gt=s.memo((function({uri:e,className:t,onClick:a,size:n=Kt.t.xs}){const[i,o]=(0,Yt.A)(e),r=(0,s.useCallback)((e=>{e.preventDefault(),a&&a(!i),o(!i)}),[i,a,o]);return(0,N.jsx)(Kt.M,{className:t,size:n,onClick:r,isAdded:!!i,condensed:!0})}));var Wt=a(91546),Qt=a(59375),Zt=a(28153);const Xt=({uri:e,isBook:t=!1,size:a=Kt.t.xs,className:n,onClick:i})=>{const{isPreSaved:o,addPresave:r,removePresave:c}=(0,Zt.w)({uri:e,isBook:t}),l=(0,s.useCallback)((()=>{o?c():r(),i?.(!o)}),[o,i,c,r]);return(0,N.jsx)(Kt.M,{className:n,size:a,onClick:l,isAdded:!!o,condensed:!0})};var $t=a(19672),Jt=a(30254),ea=a(8392),ta=a(81952),aa=a(35054),sa=a(37673),na=a(37861),ia=a(92019),oa=a(27847),ra=a(90471),ca=a(29425);function la(e){return(0,ca.v)(e)||(0,ra.p)(e)}const ua=vt.$S.NPV_BUTTON_CLICK,da=()=>{const e=(0,Ze.l)(),t=(0,G.NC)(J.wZE),a=(0,Q.S)(),n=(0,qe._Y)();return(0,s.useCallback)((()=>{a===W.z.CLOSED?t?e(W.z.NOW_PLAYING_VIEW):n(ua):e(W.z.CLOSED)}),[t,a,n,e])};var ma=a(65758),ga=a(28054),pa=a(68293),va=a(53369);const ba=({spec:e})=>{const t=(0,pa.s)(),a=(0,St.L)(),{draggable:n,onDragStart:i}=(0,ga.P)(),o=(0,Q.S)(),r=da(),{images:l}=(0,ma.u)(a?.item),u=o===W.z.NOW_PLAYING_VIEW,d=(0,s.useCallback)((()=>{r();const a=u?e.hitUiHide():e.hitUiReveal();t.logInteraction(a)}),[u,t,e,r]);if(null===a)return null;const{context:m,item:g}=a;return(0,N.jsx)(aa.h,{menu:(0,N.jsx)(na.W,{context:m,item:g}),children:(0,N.jsx)("div",{draggable:n&&la(g),onDragStart:e=>{i(e,{itemUris:[g.uri],dragLabelText:(0,oa.r)(g)})},children:(0,N.jsx)(ia.R,{uri:m.uri,owner:m.metadata?.context_owner,children:(0,N.jsx)("button",{type:"button","data-testid":"cover-art-button",className:va.A.coverArtButton,"aria-label":c.Ru.get("web-player.now-playing-view.label"),onClick:d,children:(0,N.jsx)(sa.b,{images:l,type:g.type,size:56,maxSize:56,className:va.A.coverArt})})})})})};var ya=a(83498),ha=a(96573),Ca=a(27689),ka=a(87338);const xa="main-coverSlotCollapsed-container",Na="main-coverSlotCollapsed-expandButton",fa=vt.$S.NPV_BUTTON_CLICK,ja=({children:e,className:t,spec:a})=>{const n=(0,pa.s)(),o=(0,qe.Ev)(fa),r=(0,Q.S)(),{isActive:l}=(0,qe.AI)(He.Z.NowPlayingView),u=(0,G.NC)(J.wZE),d=da(),m=(0,s.useMemo)((()=>{if(u){const e=r===W.z.NOW_PLAYING_VIEW;return{label:e?c.Ru.get("web-player.cinema-mode.minimize"):c.Ru.get("web-player.now-playing-view.cinema-mode.expand"),Icon:e?ya.b:ha.L,isActive:e,isDisabled:!1}}return{label:l?c.Ru.get("npb.collapseCoverArt"):c.Ru.get("npb.expandCoverArt"),Icon:l?Ca.r:ka.o,isActive:l,isDisabled:!o}}),[u,o,r,l]),g=(0,s.useCallback)((()=>{d();const e=a.coverartArrowFactory(),t=m.isActive?e.hitUiHide():e.hitUiReveal();n.logInteraction(t)}),[n,a,m.isActive,d]);return(0,N.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:i()(xa,t),children:[e,(0,N.jsx)(ie.Zp,{label:m.label,children:(0,N.jsx)("button",{className:i()(Na),disabled:m.isDisabled,onClick:g,"aria-label":m.label,"aria-pressed":m.isActive,children:(0,N.jsx)(m.Icon,{iconSize:16})})})]})};var Aa=a(85397),Ia=a(36999),Sa=a(56491);var Ta=a(71990),Da=a(64589),Pa=a(62138),wa=a(33361),Ea=a(86541),Ra=a(52593),Ba=a(52613),Oa=a(52887),_a=a(89457),Fa=a(23291),La=a(1287);const Va=({context:e,item:t,onLike:a})=>{const s=(0,wa.X)(),n=(0,Pa.C)(),i=(0,Jt.v)(t);if(s&&n&&(0,Da.N)(t))return(0,N.jsx)(Ta.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(i)return(0,N.jsx)($t.g,{uri:t.uri,condensed:!0});if((0,ca.v)(t))return t.isLocal?null:(0,N.jsx)(Qt.b,{uri:t.uri,className:"control-button control-button-heart",onClick:a});if((0,ra.p)(t))return(0,N.jsx)(Wt.b,{condensed:!0,uri:t.uri,className:"control-button control-button-heart",onClick:a});if((0,Oa.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,N.jsx)(Xt,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:a}):(0,N.jsx)(Gt,{uri:t.book.uri,className:"control-button control-button-heart",onClick:a})}return(0,Ba.N)(t)||(0,_a.v)(t)?null:(0,La.d)(t)},Ma=({state:{item:e,context:t,index:a}})=>{!function(e){const t=(0,Sa.i)(),a=(0,Ia.X)(e);(0,s.useEffect)((()=>{a&&t.say(a)}),[a,t])}(e);const{videoPlayerMode:n,setVideoPlayerUIFlag:i}=(0,Ea.d)(),{spec:o,logger:r}=(0,w.r)(_t.p6,{data:{identifier:_t.gw.DESKTOP}}),c=(0,Ia.P)(e),l=(0,G.NC)(J.WAA);(0,s.useEffect)((()=>{i(Ra.nP.nowPlayingBar,l)}),[l,i]);const u=n===Ra.Kz.nowPlayingBar&&l,d=(0,s.useMemo)((()=>o.coverartFactory({uri:e.uri})),[e.uri,o]);return(0,N.jsx)(s.Suspense,{fallback:null,children:(0,N.jsx)("div",{"data-testid":"now-playing-widget",className:va.A.nowPlaying,role:"region","aria-label":c,children:(0,N.jsxs)(Fa.r,{spec:o,children:[(0,Ba.N)(e)?(0,N.jsx)(Ht,{item:e,context:t,index:a}):(0,N.jsxs)(ja,{className:va.A.coverArtCollapsed,spec:d,children:[!u&&(0,N.jsx)(ba,{spec:d}),l&&(0,N.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,N.jsx)(ea.d,{context:t,className:va.A.contextItemInfo,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(o.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(o.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:ta.G.NPB}),(0,N.jsxs)("div",{className:va.A.controls,children:[(0,N.jsx)(Aa.a,{context:t,item:e,onClick:()=>{r.logInteraction(o.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,N.jsx)(Va,{item:e,onLike:t=>{r.logInteraction(t?o.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):o.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},Ua=()=>{const e=(0,St.L)();return null===e?(0,N.jsx)("div",{className:i()("now-playing")}):(0,N.jsx)(Ma,{state:e})};var za=a(39418);const qa="aguQsGoZR9wZeawKGdDh",Ha="ieqOSqJb6kk3bG5XDOHk",Ka=({paused:e,fromSeconds:t})=>{const[a,n]=(0,s.useState)(t);return(0,za.$)((t=>{n((a=>e?a:a>0?a-1:(t(),a)))}),1e3),(0,N.jsxs)("div",{className:qa,children:[c.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,N.jsx)("span",{className:Ha,children:a})]})};var Ya=a(36991);const Ga=({children:e})=>{const t=(0,b.o)((e=>e),((e,t)=>(0,U.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),a=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),s=t?.isPaused??!1,n=(0,Ya.qc)(t),i=(0,Ya.Tv)(t),r=(0,o.d4)((e=>n?e?.ads?.audio?.info?.skippableAdDelaySeconds:i?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return a&&r?(0,N.jsx)(Ka,{paused:!!s,fromSeconds:r}):(0,N.jsx)(N.Fragment,{children:e})};var Wa=a(90238),Qa=a(93844);var Za=a(63181),Xa=a(19239);const $a=e=>{const[t,a]=(0,s.useState)(new Map),[n,i]=(0,s.useState)(),o=(0,Za.L)(),r=(0,Qa.mr)(),{currentDevice:c}=(0,Ke.l)(),l=(0,Xa.vh)(),u=(0,s.useCallback)((()=>{if(!e)return;const s=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:a,setRecentAds:s,playerStateItem:n,currentDevice:i})=>{let o={isMissingAdData:!1};if(n&&n.uri!==e?.uri){if(e?.type===Lt.c.AD){const t=e?.uri.split(":")[2];t&&a.has(t)?s((e=>{const a=new Map(e);return a.delete(t),a})):o={isMissingAdData:!0,errorMessage:i.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>n))}return o})({lastRecordedItem:n,setLastRecordedItem:i,recentAds:t,setRecentAds:a,playerStateItem:o?.item,currentDevice:c});if(s.isMissingAdData){const{errorMessage:e,adId:t}=s;l.send((0,Wa.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[o,n,t,l,c,e]),d=(0,s.useCallback)((()=>{e&&r&&a((e=>{let a=e;return t.has(r.adId)||(a=new Map(e).set(r.adId,r)),a}))}),[t,r,e]);(0,s.useEffect)((()=>{u()}),[u]),(0,s.useEffect)((()=>{d()}),[d])};var Ja=a(72293),es=a(55710),ts=a(85272),as=a(53627),ss=a(48671),ns=a(23009),is=a(21771),os=a(98859),rs=a(8800),cs=a(49019);const ls="player-controls",us="player-controls__buttons",ds="player-controls__left",ms="player-controls__right",gs=(0,s.memo)((function({item:e}){const t=as.Q.isPodcastAd(e),a=as.Q.isSurveyAd(e);return(0,N.jsxs)("div",{"data-testid":"ad-controls",className:us,children:[(0,N.jsxs)("div",{className:ds,children:[t&&(0,N.jsx)(cs.w,{}),(0,N.jsx)(ts.T,{item:e,isDisabled:a}),t?(0,N.jsx)(ns.h,{}):(0,N.jsx)(os.d,{})]}),(0,N.jsx)(ss.x,{}),(0,N.jsxs)("div",{className:ms,children:[t?(0,N.jsx)(is.v,{}):(0,N.jsx)(Ga,{children:(0,N.jsx)(rs.$,{})}),(0,N.jsx)(es.t,{item:e,isDisabled:a})]})]})}));var ps=a(16722),vs=a(88127);var bs=a(30317),ys=a(42681),hs=a(68888);var Cs=a(89809),ks=a(36473),xs=a(86582),Ns=(a(77369),a(28718)),fs=a(54542),js=a(86148),As=a(46235),Is=a(43529);const Ss="mkROcxw9LM6F2uuwQYjN",Ts="lS8fuNpwL8OBGhloXNdh",Ds="iAOrGKFACLqwN5OOPDOt",Ps="x7x6PBvBMU9lusyUfedS",ws=function({setSleepTimer:e,state:t,formattedTimeLeft:a}){const{item:s}=(0,Za.L)()??{},n=t.type===Is.dq.NONE?Is.Xe:Is.Xe.concat(Is.k1.Off),i=t.type!==Is.dq.NONE&&t.timestamp?c.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",a):c.Ru.get("web-player.sleep-timer.player-controls.popover.title"),o=t=>()=>e(t);return(0,N.jsxs)(Ns.W,{"aria-label":i,children:[(0,N.jsx)(fs.y,{className:Ts,children:(0,N.jsx)("span",{className:Ds,children:i})}),n.map((e=>{const t=(0,As.I)(e,s?.type??Lt.c.EPISODE);return(0,N.jsx)(js.D,{onClick:o(e),"data-testid":`playback-sleep-timer-option-${e}`,role:"menuitemradio","aria-label":t,children:t},e)}))]})};var Es=a(46580),Rs=a(7381),Bs=a(25669),Os=a(31159);let _s=function(e){return e[e.DEACTIVATED=0]="DEACTIVATED",e[e.ACTIVATED=1]="ACTIVATED",e}({});const Fs="scale(0.97)",Ls={[_s.DEACTIVATED]:{Icon:Rs.l,transitions:{[_s.ACTIVATED]:{animationFilePath:(0,Bs.bj)("animations/stopwatch_activate.json"),style:{transform:Fs}}}},[_s.ACTIVATED]:{Icon:e=>{const{className:t,...a}=e;return(0,N.jsx)("span",{className:Ss,children:(0,N.jsx)(Os.x,{className:i()(t),...a})})},transitions:{[_s.DEACTIVATED]:{animationFilePath:(0,Bs.bj)("animations/stopwatch_deactivate.json"),style:{transform:Fs}},[_s.ACTIVATED]:{animationFilePath:(0,Bs.bj)("animations/stopwatch_activate.json"),style:{transform:Fs}}}}};var Vs=a(27958),Ms=a(9131);const Us=e=>Math.max(0,e-Date.now()),zs=({uri:e,onClick:t})=>{const a=(0,G.NC)(J.GhO),n=(0,Ae.z)(),[i,o]=(0,Es.y)(),r=i.type!==Is.dq.NONE,{timestamp:l}=i,[u,d]=(0,s.useState)((()=>l?Us(l):0)),{logger:m,spec:g}=(0,w.r)(Cs.h,{data:{uri:e}}),p=(0,s.useMemo)((()=>l?(0,Ms.f)(u):""),[u,l]),{setState:v,Icon:b}=(0,Vs.Q)(r?_s.ACTIVATED:_s.DEACTIVATED,Ls),h=(0,s.useCallback)((a=>{o(a),t?.(a),v(a===Is.k1.Off?_s.DEACTIVATED:_s.ACTIVATED);const s=(0,As.p)(a,g,e);m.logInteraction(s)}),[o,t,v,g,e,m]);if((0,s.useEffect)((()=>{if(!l)return void d(0);const e=()=>d(Us(l));e();const t=setInterval(e,1e3);return()=>{clearInterval(t)}}),[l]),!a)return null;const C=c.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),k=r&&p?`${C} - ${c.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",p)}`:C,x=r&&l,f=n.getCapabilities().canUseSleepTimer;return(0,N.jsx)(ks.t,{placement:"top-start",menu:(0,N.jsx)(ws,{state:i,setSleepTimer:h,formattedTimeLeft:p}),children:(e,t,a)=>{const s=(0,N.jsx)(ne.H,{ref:a,iconLeading:b,size:"small",onClick:f?t:void 0,role:"checkbox","aria-label":k,"data-testid":"control-button-sleep-timer","aria-checked":r,semanticColor:r?"textBrightAccent":void 0,children:x&&(0,N.jsx)(y.E,{variant:"marginal",semanticColor:"textBrightAccent",className:Ps,children:p})});return(0,N.jsx)(ie.Zp,{label:C,children:f?s:(0,N.jsx)(xs.$,{type:"sleep-timer",children:s})})}})};var qs=a(8578),Hs=a(82719);const Ks=(0,s.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:a,logChangeShuffleMode:n,logSeekForward:i,logSeekBack:o,logSkipForward:r,logSkipBack:l,logPlayPause:u,logProgressChanged:d,spec:m}=(()=>{const e=(0,Ae.z)(),{spec:t,logger:a}=(0,w.r)(bs.kD,{data:{identifier:bs.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,s.useCallback)((s=>{const n=e.getState();n?.item&&a.logInteraction(t.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:n.item.uri,playbackSpeed:s}))}),[a,e,t]),logChangeShuffleMode:(0,s.useCallback)((e=>{a.logInteraction(e?t.shuffleButtonFactory().hitShuffleEnable():t.shuffleButtonFactory().hitShuffleDisable())}),[a,t]),logChangeRepeatMode:(0,s.useCallback)((e=>{const s={[ys.p.REPEAT_NONE]:t.repeatButtonFactory().hitRepeatDisable(),[ys.p.REPEAT_TRACK]:t.repeatButtonFactory().hitRepeatOneEnable(),[ys.p.REPEAT_CONTEXT]:t.repeatButtonFactory().hitRepeatEnable()};a.logInteraction(s[e])}),[a,t]),logSeekBack:(0,s.useCallback)((e=>{a.logInteraction(t.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,t]),logSeekForward:(0,s.useCallback)((e=>{a.logInteraction(t.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,t]),logSkipBack:(0,s.useCallback)((()=>{const s=e.getState();s&&a.logInteraction(t.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:s.item?.uri||"",positionMs:(0,hs.s)(s)??-1,totalContentMs:s.duration??-1}))}),[a,e,t]),logSkipForward:(0,s.useCallback)((()=>{const s=e.getState();s?.item&&a.logInteraction(t.nextButtonFactory().hitSkipToNext({itemToBeSkipped:s.item.uri,positionMs:(0,hs.s)(s)??-1,totalContentMs:s.duration??-1}))}),[a,e,t]),logPlayPause:(0,s.useCallback)((s=>{const n=e.getState();n?.item&&("resume"===s?a.logInteraction(t?.playPauseButtonFactory().hitResume({itemToBeResumed:n.item.uri})):"pause"===s&&a.logInteraction(t?.playPauseButtonFactory().hitPause({itemToBePaused:n.item.uri})))}),[a,e,t]),logProgressChanged:(0,s.useCallback)(((e,s)=>{switch(s){case"drag":return a.logInteraction(t.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return a.logInteraction(t.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,La.k)(s)}}),[a,t]),spec:t}})();$a((0,G.NC)(J.KYh));const g=(0,b.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=function(){const e=(0,b.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,ra.p)(e)||(0,Oa.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,Ba.N)(e)&&e.isPodcastAd}();return(0,N.jsx)("div",{className:ls,"data-testid":"player-controls",dir:"ltr","aria-label":c.Ru.get("playback-control.a11y.landmark-label"),children:(0,N.jsxs)(Fa.r,{spec:m,children:[(0,Ba.N)(g)?(0,N.jsx)(gs,{item:g}):(0,N.jsxs)("div",{className:us,"data-testid":"general-controls",children:[(0,N.jsxs)("div",{className:ds,children:[p?(0,N.jsx)(cs.w,{onClick:t}):(0,N.jsx)(Hs.w,{renderEnabled:()=>(0,N.jsx)(qs.a,{size:"small"}),renderDisabled:()=>(0,N.jsx)(vs.u,{onClick:n})}),p&&(0,N.jsx)(ns.h,{onClick:o}),(0,N.jsx)(os.d,{onClick:l})]}),(0,N.jsx)(ss.x,{onClick:u}),(0,N.jsxs)("div",{className:ms,children:[(0,N.jsx)(Ga,{children:(0,N.jsx)(rs.$,{onClick:r})}),p?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(is.v,{onClick:i}),(0,N.jsx)(zs,{uri:g?.uri??""})]}):(0,N.jsx)(ps.s,{onClick:a})]})]}),(0,N.jsx)(Ja.x,{isPreview:e,onChange:d})]})})}));var Ys=a(86247),Gs=a(37311),Ws=a(56627);const Qs="main-nowPlayingBar-container",Zs="main-nowPlayingBar-nowPlayingBar",Xs="MWD1i_CSJ5N9wRBDpZmX",$s="k3NVrHXkbfflNdAxpT1_",Js="m8UPWsNtWbdkvBNvqgBN",en="aepuRyT82biv_XmkH1eS",tn="main-nowPlayingBar-left",an="main-nowPlayingBar-center",sn="main-nowPlayingBar-right",nn="K7b2iysmIbvKo8RqRbc5",on="adzMqeRxU0__wQcuju5q",rn=(0,s.memo)((()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht),t=(0,o.wA)(),a=(0,b.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),n=(0,j.h)();(()=>{const e=(0,o.d4)(v.Yb),{mode:t,setMode:a}=(0,$.r)(),n=(0,s.useRef)(void 0),i=(0,b.o)((e=>e?.item?.uri)),r=(0,G.NC)(J.L$q),c=(0,Q.S)(),l=(0,Z.r)(),u=(0,X.F)(),d=c===W.z.NOW_PLAYING_VIEW&&"lyrics"===l.currentVariant;(0,s.useEffect)((()=>{n.current&&t!==ee.YU.none&&n.current!==i&&(e||r===J.vkU.REDUCED_VISIBILITY)&&(t===ee.YU.npv&&a(ee.YU.static),d&&u(l.previousVariant??"artwork")),n.current=i}),[l.previousVariant,e,d,r,t,u,a,i])})();const y=(0,b.o)((e=>(0,Ba.N)(e?.item??void 0)));(()=>{const e=(0,s.useRef)(null),t=(0,s.useRef)(!1),a=(0,o.wA)(),n=(0,o.d4)(d.qn),i=(0,o.d4)(v.Um),r=(0,b.o)((e=>e?.context.uri),((e,t)=>e===t));(0,s.useEffect)((()=>{const s=e.current,o=s&&(0,g.Z_)(n??[],s,2),c=r&&(0,g.Z_)(n??[],r,2);s!==r&&(o||c)&&i&&m.adsCoreConnector.clearSlot(p.r.stream),c!==t.current&&(a((0,u.uM)(!!c)),t.current=!!c),e.current=r??null}),[r,n,i,a])})();const h=(0,s.useCallback)((e=>{e.stopPropagation(),t((0,l.Ai)())}),[t]),C=()=>(0,N.jsx)(Ys.ql.Provider,{value:"now_playing_bar",children:(0,N.jsxs)("div",{className:e?Xs:Zs,children:[(0,N.jsx)("div",{className:tn,children:(0,N.jsx)(Ua,{})}),(0,N.jsx)("div",{className:an,children:(0,N.jsx)(s.Suspense,{fallback:null,children:(0,N.jsx)(Ks,{isPreview:e})})}),(0,N.jsx)("div",{className:sn,children:(0,N.jsx)(Ot,{})})]})});return(0,N.jsx)(Ws.P,{surface:Gs.u.NOW_PLAYING,children:(0,N.jsxs)("aside",{"aria-label":c.Ru.get("playback-control.a11y.now-playing-bar-landmark-label"),className:i()(Qs,nn,{[on]:n}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(y?"ad":"none"),children:[e?(0,N.jsx)(f,{handleClick:h}):null,e?(0,N.jsx)(r.A,{in:a?.hasContext??!1,timeout:200,classNames:{enter:$s,enterActive:Js,enterDone:en},children:C()}):C(),(0,N.jsx)(Y,{})]})})}))}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map